智链云维 · 产品需求说明书（PRD）

---

1. 文档目的
   本文档用于定义“智链云维”智能运维平台的核心业务需求、功能需求、非功能需求及验收标准，供产品、研发、测试、运维、商务等各方统一认知并指导后续迭代。

---

2. 产品定位
   一句话描述：

> 面向多云与云原生环境，基于统一数据底座 + 区块链成本账本 + AI 智能体编排，提供可观测、可审计、可自愈的全链路自动化运维闭环。

---

3. 需求背景与痛点

角色	当前痛点	期望价值
平台运维团队	多云账单分散，成本不可追溯；故障定位耗时长；重复性脚本多	一份实时、可信的成本账；分钟级故障自愈
财务/审计	云费用缺乏不可篡改的原始凭据；碳排、SLA 罚金无法精确分摊	区块链级审计报告，一键导出
CTO	多套监控/日志工具割裂；AI 能力难以落地到自动化	统一数据底座 + 低代码编排，AI 即插即用

---

4. 目标用户
1. 主要用户
    - 中大型企业运维团队（多云 K8s、IaaS、PaaS）
    - 金融、互联网、SaaS 厂商（强审计、合规需求）
2. 次要用户
    - 云 MSP / 集成商（二次售卖）
    - 财务、审计、合规部门（只读视图）

---

5. 需求范围

5.1 业务范围
- 支持 AWS、阿里云、腾讯云、华为云、私有云（OpenStack、K8s）
- 覆盖日志、对象存储、区块链三类数据的采集、治理、消费
- 不覆盖：业务应用性能监控（APM）、纯 CMDB 资产库

5.2 功能范围

模块	核心功能	说明
统一数据底座	日志数据池	多源日志采集 → 格式化 → 实时索引 → 搜索/告警 API
对象存储数据池	冷/热分层归档；生命周期管理；S3 兼容 API
区块链数据池	运维成本实时写入链；IPFS 文件索引；审计查询 API
智能体编排	n8n 工作流引擎	可视化拖拽；200+ 原子节点（监控/告警/工单/弹性扩缩容）
AI 能力	异常检测	无监督/半监督模型；支持 KPI、日志模式、资源利用率
根因定位	基于知识图谱的故障拓扑定位
自愈建议	生成可执行的修复脚本/工作流

---

6. 功能需求

6.1 日志数据池

需求编号	需求描述	优先级	验收标准
LOG-001	支持 Filebeat/Fluent Bit 采集器一键接入	P0	5 分钟内完成一个业务命名空间接入
LOG-002	日志格式自动标准化（JSON/CSV/自定义 Grok）	P0	99% 字段成功解析
LOG-003	提供全文检索与 Lucene 语法	P0	查询延迟 <500 ms（1 亿条以内）
LOG-004	内置异常检测规则模板（如 Pod CrashLoopBackOff）	P1	误报率 <5%

6.2 对象存储数据池

需求编号	需求描述	优先级	验收标准
OBJ-001	支持 AWS S3、阿里云 OSS、MinIO 作为后端	P0	单桶 1 TB 数据迁移完成无丢
OBJ-002	生命周期策略（30 天热→冷→归档）	P0	策略生效延迟 <1 min
OBJ-003	提供 RESTful API 生成预签名 URL	P1	支持 7 天有效期

6.3 区块链数据池

需求编号	需求描述	优先级	验收标准
CHAIN-001	运维成本实时上链（资源单价、用量、账单、碳排、SLA 罚金）	P0	上链延迟 <30 s
CHAIN-002	提供链上交易哈希查询 & PDF 审计报告导出	P0	报告可验证签名
CHAIN-003	支持国密算法（SM2/SM3/SM4）合规	P1	通过密评测试

6.4 智能体编排

需求编号	需求描述	优先级	验收标准
WF-001	200+ 原子节点（Shell、HTTP、K8s、云 API、飞书/钉钉）	P0	节点可用率 ≥99.9%
WF-002	工作流版本管理 & 回滚	P0	一键回滚 <10 s
WF-003	变量与密钥托管（KMS 集成）	P1	密钥不落盘

6.5 AI 异常检测

需求编号	需求描述	优先级	验收标准
AI-001	支持 CPU、内存、网络、磁盘、日志模式检测	P0	5 分钟内发现异常
AI-002	根因定位准确率 ≥60%	P1	人工复核 top3 根因命中率
AI-003	一键生成自愈工作流	P2	可执行脚本覆盖率 ≥80%

---

7. 非功能需求

类别	需求项	指标
性能	日志写入 TPS	≥50 万条/分钟
API P99 延迟	<1 s
可用性	整体 SLA	≥99.9 %
RTO / RPO	≤30 min / ≤10 min
可扩展性	支持水平扩容	节点数无上限（K8s HPA）
安全	传输加密	TLS 1.3 / 国密 HTTPS
存储加密	AES-256 / 国密 SM4
合规	等保三级 / 密评	取得证书

---

8. 数据字典（核心实体）

实体	关键字段	示例
日志记录	`timestamp`, `pod`, `severity`, `message`	`2025-08-12T09:00:00Z`, `payment-7d9c8f6b`, `ERROR`, `OutOfMemory`
成本记录	`resource_id`, `cost_type`, `amount`, `carbon_g`, `sla_penalty`	`i-0abcd1234`, `cpu_hour`, `0.045`, `120`, `0`
工作流实例	`wf_id`, `status`, `start_time`, `end_time`, `output`	`wf_heal_oom`, `success`, `2025-08-12T09:01:00Z`, `09:01:30Z`, `pod restarted`

---

9. 边界 & 约束
- 暂不实现：
    - 传统非容器化主机监控
    - 实时 APM Trace 接入
- 外部依赖：
    - 云厂商 API Rate Limit ≤1000 req/min
    - Hyperledger Fabric 版本 v2.5.x

---

10. 里程碑 & 交付物

阶段	日期	交付物	验收标准
MVP	2025-11-12	对象存储数据池 + 基础 UI	上传/下载 1 GB 文件无错
Alpha	2026-02-12	日志数据池 + 区块链账本 POC	5 万条日志上链 <5 min
Beta	2026-05-12	智能体编排 & AI 检测	完整跑通“异常→自愈”案例
GA	2026-08-12	全功能 + SLA 认证	线上压测 7 天无故障

---

11. 风险与假设

风险	影响	缓解措施
Fabric 交易性能瓶颈	上链延迟 >60 s	提前做 10 k TPS 压测；必要时换 BFT-SMaRt
多云 API 限流	任务失败	指数退避 + 本地队列缓存
用户不会写工作流	采用率低	提供 20 个官方模板 + 低代码培训视频

---

12. 附录
- 术语表：SLA、RTO、RPO、FinOps、Hyperledger Fabric
- 原型链接（Figma）
- 参考文档：
    - VictoriaLogs 官方文档
    - n8n Workflow 规范

---

> 评审后请在此文档右上角用 Git tag `prd-v1.0` 归档，后续变更以 PR 形式更新。